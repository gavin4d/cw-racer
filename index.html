<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Morse Code Speed Test</title>
  <link rel="icon" type="image/x-icon" href="./img/favicon.ico">

  <script src="./scripts/sounder.js"></script>
  <script src="./scripts/morse-tools/decoder.js"></script>
  <script src="./scripts/morse-tools/keyer.js"></script>
  <script src="./scripts/morse-tools/encoder.js"></script>
  <script src="./scripts/main.js"></script>
  <link rel="stylesheet" href="./css/style.css" type="text/css" as="style" />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,500,0,0&icon_names=refresh,settings" />
</head>

<body>
  <fieldset class="panel mode-selector">
    <!-- <button id="scratch-mode">Scratch</button> -->
    <input name="mode" id="copy-mode" type="radio">
    <label for="copy-mode">Copy</label>
    <input name="mode" id="send-mode" type="radio" checked>
    <label for="send-mode">Send</label>
    <input name="settings" id="settings-toggle" type="checkbox">
    <label for="settings-toggle">
      <!-- <img src="img/settings_24dp_1F1F1F_FILL0_wght500_GRAD0_opsz24.svg" alt="Settings"> -->
      <span class="material-symbols-rounded">
        settings
      </span>
    </label>
  </fieldset>
  <div class="panel settings-panel">
    <div class="settings-group">
      <label for="mode">Keyer Mode:</label>
      <select id="mode">
        <option value="1">Straight Key</option>
        <option value="2" selected>Iambic A</option>
        <option value="3">Iambic B</option>
        <option value="4">Ultimatic</option>
        <!-- <option value="5">Bug</option> -->
      </select>
    </div>

    <div class="settings-group">
      <label for="wpm">Speed (WPM):</label>
      <input type="range" id="wpm" min="10" max="45" value="20" title="Speed (WPM)">
      <span id="wpmValue" class="value-display">20</span>
    </div>

    <!-- <div class="settings-group"> -->
    <!-- <label>Calculated WPM:</label> -->
    <!-- <span id="calculatedWpmValue" class="value-display">--</span> -->
    <!-- </div> -->

    <div class="settings-group">
      <label for="farnsworth">Farnsworth:</label>
      <input type="range" id="farnsworth" min="1" max="10" value="2">
      <span id="farnsworthValue" class="value-display">2x</span>
    </div>

    <div class="settings-group">
      <label for="tone">Tone (Hz):</label>
      <input type="range" id="tone" min="400" max="1000" value="550">
      <span id="toneValue" class="value-display">550</span>
    </div>
    <div class="settings-group">
      <label for="practice-length">Practice Length (Words):</label>
      <input type="number" id="practice-length" value="10" min="1">
    </div>
    <div class="settings-group">
      <label for="stats-toggle">
        Display statistics during test:
        <!-- <img src="img/bar_chart_24dp_1F1F1F_FILL0_wght500_GRAD0_opsz24.svg" alt="Stats"> -->
      </label>
      <input name="stats" id="stats-toggle" type="checkbox">
    </div>
    <div class="settings-group">
      <label for="strict-toggle">
        Require correct character:
      </label>
      <input name="spaces" id="strict-toggle" type="checkbox" checked>
    </div>
    <div class="settings-group">
      <label for="wait-input-toggle">
        Copy single character at a time:
      </label>
      <input name="wait-input" id="wait-input-toggle" type="checkbox" checked>
    </div>
    <div class="settings-group">
      <label for="replay-toggle">
        Replay character on incorrect:
      </label>
      <input name="replay" id="replay-toggle" type="checkbox">
    </div>
    <div class="settings-group">
      <label for="spaces-toggle">
        Display spaces as gaps:
      </label>
      <input name="spaces" id="spaces-toggle" type="checkbox" checked>
    </div>

    <div class="settings-group">
      <label for="mode">Wordlist:</label>
      <fieldset id="wordlist">
        <div class="settings-group multiselect">
          <input name="wordlist" id="wordlist-1k" type="checkbox" checked>
          <label for="wordlist-1k">1000 words</label>
        </div>
        <div class="settings-group multiselect">
          <input name="wordlist" id="wordlist-callsigns" type="checkbox" checked>
          <label for="wordlist-callsigns">Callsigns</label>
        </div>
        <div class="settings-group multiselect">
          <input name="wordlist" id="wordlist-q-codes" type="checkbox">
          <label for="wordlist-q-codes">Q-Codes</label>
        </div>
        <div class="settings-group multiselect">
          <input name="wordlist" id="wordlist-custom" type="checkbox">
          <label for="wordlist-custom">Custom file</label>
        </div>
      </fieldset>
      <input type="file" id="wordlist-custom-file" accept="text/plain">
      <label for="wordlist-custom-file">Upload File</label>
    </div>
    <div class="settings-group">
      <label for="mode">Theme:</label>
      <fieldset>
        <div class="settings-group multiselect">
          <input name="theme" id="light" type="radio">
          <label for="light">Light</label>
        </div>
        <div class="settings-group multiselect">
          <input name="theme" id="dark" type="radio" checked>
          <label for="dark">Dark</label>
        </div>
        <div class="settings-group multiselect">
          <input name="theme" id="neuromorphic" type="radio">
          <label for="neuromorphic">Neuromorphic</label>
        </div>
      </fieldset>
    </div>
  </div>

  <div class="panel target-input">
    <div class="carrots-crate">
      <div class="carets" id="caret"></div>
      <!-- <div class="carets" id="soundCaret"></div> -->
    </div>
    <div id="targetInput">
    </div>
    <button id="clear-button" type="button" title="Restart [Enter]">
      <!-- <img class="show-on-start" src="img/refresh_24dp_1F1F1F_FILL0_wght500_GRAD0_opsz24.svg" alt="Restart"> -->
      <span class="material-symbols-rounded show-on-start">
        refresh
      </span>
      <span class="instructions show-in-send">
        Use <span class="keybind">[</span> for dot and <span class="keybind">]</span> for
        dash.
      </span>
      <span class="instructions show-in-copy">
        Use <span class="keybind">space</span> to start. Type the characters you hear.
      </span>
    </button>
    <input class="" id="mobileInput" type="password" />
  </div>

  <div class="panel input-panel">
    <div class="num-display">
      <label for="lastInput">Last Input</label>
      <div id="lastInput" class="last-input"></div>
    </div>
    <div class="timing-container">
      <div class="timing-row">
        <span class="timing-label">Actual:</span>
        <div id="actualTimingDisplay" class="timing-bar"></div>
      </div>
      <div class="timing-row">
        <span class="timing-label">Ideal:</span>
        <div id="idealTimingDisplay" class="timing-bar"></div>
      </div>
    </div>
  </div>

  <!-- <div class="panel mobile-buttons hidden"> -->
  <!-- <button id="ditButton"> -->
  <!-- <svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"> -->
  <!-- <circle r="5" cx="5" cy="5" fill="var(--text)"> -->
  <!-- </svg> -->
  <!-- </button> -->
  <!-- <button id="dahButton"> -->
  <!-- <svg viewBox="0 0 30 10" xmlns="http://www.w3.org/2000/svg"> -->
  <!-- <rect width="30" height="10" x="0" y="0" rx="5" ry="5" fill="var(--text)" /> -->
  <!-- </svg> -->
  <!-- </button> -->
  <!-- </div> -->

  <div class="panel stats-panel">
    <h2>Stats</h2>
    <div class="stats-section">
      <div class="num-display wpm">
        <label for="speedStat" title="">WPM</label>
        <div id="speedStat"></div>
      </div>
      <div class="num-display accuracy">
        <label for="accuracyStat" title="">Accuracy</label>
        <div id="accuracyStat"></div>
      </div>
      <div class="num-display lettersStat">
        <label for="lettersStat" title="">Correct / Incorrect / Late</label>
        <div id="letterStat"></div>
      </div>
      <div class="stats-container letter-error"></div>
      <div class="num-display time">
        <label for="timeStat" title="">Time</label>
        <div id="timeStat"></div>
      </div>
      <!-- <div class="stats-container test-config"></div> -->
      <div id="timing-stats" class="stats-container">
        <div class="stat-item">
          <strong>Dit (ms):</strong>
          <div>Ideal: <span id="idealDit">--</span></div>
          <div class="graph-container" id="ditGraphContainer"
            style="height: 100px; width: 50px; border: 1px solid #eee; position: relative; margin-top: 5px; background-color: #fff;">
            <div class="ideal-bar"
              style="position: absolute; bottom: 0; left: 5px; width: 15px; background-color: lightblue;"></div>
            <div class="actual-range-bar"
              style="position: absolute; left: 30px; width: 15px; background-color: rgba(255, 165, 0, 0.5);"></div>
            <div class="actual-avg-marker"
              style="position: absolute; left: 28px; width: 19px; height: 2px; background-color: orange; transform: translateY(-1px);">
            </div>
          </div>
          <div>Actual (Avg/Min/Max): <span id="actualDit">-- / -- / --</span></div>
        </div>
        <div class="stat-item" style="margin-top: 10px;">
          <strong>Dah (ms):</strong>
          <div>Ideal: <span id="idealDah">--</span></div>
          <div class="graph-container" id="dahGraphContainer"
            style="height: 100px; width: 50px; border: 1px solid #eee; position: relative; margin-top: 5px; background-color: #fff;">
            <div class="ideal-bar"
              style="position: absolute; bottom: 0; left: 5px; width: 15px; background-color: lightblue;"></div>
            <div class="actual-range-bar"
              style="position: absolute; left: 30px; width: 15px; background-color: rgba(255, 165, 0, 0.5);"></div>
            <div class="actual-avg-marker"
              style="position: absolute; left: 28px; width: 19px; height: 2px; background-color: orange; transform: translateY(-1px);">
            </div>
          </div>
          <div>Actual (Avg/Min/Max): <span id="actualDah">-- / -- / --</span></div>
        </div>
        <!-- Add placeholders for space stats later if needed -->
      </div>
      <!-- New Ratio Stats Container -->
      <div id="ratio-stats" class="stats-container">
        <h2>Dit:Dah Ratio</h2>
        <p class="stat-description">Checks if average Dah duration is 3x average Dit duration.</p>
        <div class="ratio-display">
          Ideal: <span class="ideal-value">1 : 3.00</span>
        </div>
        <div class="ratio-display">
          Actual: <span id="actualRatioValue" class="actual-value">1 : ---</span>
        </div>
        <!-- Placeholder for a potential visual bar -->
        <div id="ratio-visual" class="ratio-visual-bar-container">
          <div id="ratio-bar" class="ratio-bar"></div>
          <div id="ratio-ideal-marker" class="ratio-marker ideal"></div>
          <div id="ratio-actual-marker" class="ratio-marker actual"></div>
        </div>
      </div>
    </div>
  </div>

</body>
<footer>
  <a href="https://gavinford.net">Made by: Gavin Ford</a>
  <a href="">
    <svg class="svg-icon" width="1rem" height="1rem" viewbox="0 0 98 96" xmlns="http://www.w3.org/2000/svg">
      <path fill-rule="evenodd" clip-rule="evenodd"
        d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" />
    </svg>
    Github
  </a>
</footer>

</html>